
> sharoobi-backoffice@0.1.0 test
> vitest --run --reporter verbose


 RUN  v1.6.1 /workspaces/Backoffice

 ✓ src/app/__tests__/AdminGuard.test.tsx > redirects to login when unauthenticated
 ✓ src/app/__tests__/AdminGuard.test.tsx > renders protected content when access is available
 ✓ src/hooks/__tests__/useWebSocket.mocked.test.tsx > useWebSocket (mocked) > connects and receives messages
 ✓ src/app/__tests__/AdminGuardDenied.test.tsx > shows error state when admin access fails
stderr | src/app/__tests__/CommandPalette.ai.test.tsx > CommandPalette AI suggestions > shows AI suggestion when typing
⚠️ React Router Future Flag Warning: React Router will begin wrapping state updates in `React.startTransition` in v7. You can use the `v7_startTransition` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_starttransition.
⚠️ React Router Future Flag Warning: Relative route resolution within Splat routes is changing in v7. You can use the `v7_relativeSplatPath` future flag to opt-in early. For more information, see https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath.

 ✓ src/app/__tests__/CommandPalette.ai.test.tsx > CommandPalette AI suggestions > shows AI suggestion when typing 877ms
stdout | src/app/__tests__/client.test.ts > normalizes json error responses
api_error { path: '/bff/admin/blocked', status: 403, request_id: 'req-123' }

stdout | src/app/__tests__/client.test.ts > normalizes non-json error responses
api_error { path: '/bff/admin/boom', status: 500, request_id: undefined }

 ✓ src/app/__tests__/client.test.ts > normalizes json error responses
 ✓ src/app/__tests__/client.test.ts > normalizes non-json error responses
 ✓ src/features/chat/__tests__/ChatMessageList.test.tsx > shows empty state when no messages
 ✓ src/features/chat/__tests__/ChatMessageList.test.tsx > renders message content
 ✓ src/features/payments/__tests__/api.test.ts > Payments API > should have Payments API tests defined
 ✓ src/features/payments/__tests__/api.test.ts > Payments API > should handle orders API
 ✓ src/features/payments/__tests__/api.test.ts > Payments API > should handle payment intents API
 ✓ src/features/payments/__tests__/api.test.ts > Payments API > should handle escrows API
 ✓ src/features/payments/__tests__/api.test.ts > Payments API > should handle escrow transactions API
 ✓ src/features/payments/__tests__/api.test.ts > Payments API > should handle payouts API
 ✓ src/features/payments/__tests__/api.test.ts > Payments API > should handle banks API
 ✓ src/features/payments/__tests__/api.test.ts > Payments API > should handle payment methods API
 ✓ src/features/payments/__tests__/api.test.ts > Payments API > should handle payment proofs API
 ✓ src/features/ras/__tests__/api.test.ts > RAS API > should have RAS API tests defined
 ✓ src/features/ras/__tests__/api.test.ts > RAS API > should handle session logs API
 ✓ src/features/ras/__tests__/api.test.ts > RAS API > should handle session consents API
 ✓ src/features/ras/__tests__/api.test.ts > RAS API > should handle session events API
 ✓ src/features/ras/__tests__/api.test.ts > RAS API > should handle session artifacts API
 ✓ src/features/ras/__tests__/api.test.ts > RAS API > should handle chat moderation logs API
 ✓ src/features/ras/__tests__/api.test.ts > RAS API > should handle policy audit logs API
 ✓ src/app/__tests__/DataTable.test.tsx > renders empty state when no rows
 ✓ src/app/__tests__/DataTable.test.tsx > renders loading state
 ✓ src/app/__tests__/DataTable.test.tsx > renders error state
 ✓ src/tests/a11y/axe.test.ts > Accessibility (axe) smoke > runs only when RUN_A11Y=1 is set (to avoid CI flakiness)
 ✓ src/hooks/__tests__/useWebSocket.test.tsx > useWebSocket smoke > initializes and cleans up without error
 ✓ src/features/configuration/__tests__/api.test.ts > Configuration API > should have Configuration API tests defined
 ✓ src/features/configuration/__tests__/api.test.ts > Configuration API > should handle content sections API
 ✓ src/features/configuration/__tests__/api.test.ts > Configuration API > should handle content blocks API
 ✓ src/features/configuration/__tests__/api.test.ts > Configuration API > should handle content templates API
 ✓ src/api/__tests__/ai.test.ts > api/ai > queryAI forwards request and returns results

⎯⎯⎯⎯⎯⎯ Failed Suites 2 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/accessibility/AIInsightsTray.a11y.test.tsx [ src/accessibility/AIInsightsTray.a11y.test.tsx ]
Error: Transform failed with 1 error:
/workspaces/Backoffice/src/components/icons/IconifyShim.tsx:1:9: ERROR: Expected ";" but found "React"
 ❯ failureErrorWithLog node_modules/esbuild/lib/main.js:1472:15
 ❯ node_modules/esbuild/lib/main.js:755:50
 ❯ responseCallbacks.<computed> node_modules/esbuild/lib/main.js:622:9
 ❯ handleIncomingPacket node_modules/esbuild/lib/main.js:677:12
 ❯ Socket.readFromStdout node_modules/esbuild/lib/main.js:600:7
 ❯ Socket.emit node:events:508:28

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/2]⎯

 FAIL  src/components/tailwind/__tests__/AIInsightsTray.test.tsx [ src/components/tailwind/__tests__/AIInsightsTray.test.tsx ]
Error: Transform failed with 1 error:
/workspaces/Backoffice/src/components/tailwind/__tests__/AIInsightsTray.test.tsx:24:17: ERROR: Expected ":" but found "React"
 ❯ failureErrorWithLog node_modules/esbuild/lib/main.js:1472:15
 ❯ node_modules/esbuild/lib/main.js:755:50
 ❯ responseCallbacks.<computed> node_modules/esbuild/lib/main.js:622:9
 ❯ handleIncomingPacket node_modules/esbuild/lib/main.js:677:12
 ❯ Socket.readFromStdout node_modules/esbuild/lib/main.js:600:7
 ❯ Socket.emit node:events:508:28

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/2]⎯

 Test Files  2 failed | 13 passed (15)
      Tests  35 passed (35)
   Start at  20:32:18
   Duration  30.84s (transform 1.50s, setup 3.90s, collect 8.07s, tests 1.91s, environment 9.87s, prepare 2.54s)

